# AI 课程报告 / 论文写作 Agent 系统说明

## 1. 系统概述

本系统是一个基于大模型的智能写作 Agent，用于根据用户输入的**主题**和**格式要求**，自动生成一份结构完整、格式规范、行文逻辑清晰，必要时包含图片或图表的课程报告或论文。

系统遵循 **Human-in-the-loop（人参与）** 的设计原则，生成结果为**可完全编辑的文档**，而非不可修改的最终成品。

---

## 2. 核心功能需求

### 2.1 自动生成论文 / 报告

系统应能够根据用户提供的信息，生成一份完整的论文或课程报告。

#### 2.1.1 输入内容

用户可输入以下信息：
- 报告 / 论文主题
- 报告类型（课程报告 / 实验报告 / 研究报告等）
- 具体格式要求，包括但不限于：
  - 字数要求
  - 章节结构
  - 标题层级
  - 引用格式（APA / IEEE / GB/T 等）
  - 字体、字号、行距等排版要求
- 可选信息：
  - 是否需要插入图片或图表
  - 写作风格要求（学术 / 正式）

#### 2.1.2 输出要求

系统生成的文档必须满足：
- 结构清晰，章节划分合理
- 行文逻辑通顺，符合学术写作规范
- 严格遵守用户指定的格式要求
- 在需要时自动插入：
  - 图表
  - 示例图片
  - 图注和编号

生成结果必须为**可编辑文档格式**（如 Word）。

---

### 2.2 文档可编辑能力

系统必须保证用户对生成文档拥有完全编辑权限。

#### 2.2.1 编辑支持

生成的文档需支持 Word 所支持的全部常规操作，包括但不限于：
- 文本的新增、删除与修改
- 段落顺序调整
- 样式和格式修改
- 引用内容的人工调整
- 图片位置调整或替换

系统不得对文档内容进行锁定。

---

#### 2.2.2 人机协作流程

系统工作流程应支持：
- Agent 生成初始草稿
- 用户可手动修改任意内容
- 用户可指定：
  - 对某一章节重新生成
  - 对某一段落进行润色或改写
- 局部修改不应影响文档其他部分

---

### 2.3 引用来源可查看

系统必须提供清晰、可追溯的引用信息。

#### 2.3.1 引用管理要求

- 报告中出现的每一条引用：
  - 必须在参考文献列表中存在
  - 必须对应真实、可验证的来源
- 引用与正文内容需建立明确对应关系

---

#### 2.3.2 引用页面查看能力

系统应支持用户：
- 查看引用对应的原始网页或文档（如 PDF）
- 明确某一段正文引用了哪些来源

实现形式包括但不限于：
- 正文中的引用编号
- 引用列表中的可点击链接
- 引用内容预览窗口

---

## 3. Agent 架构设计

### 3.1 Agent 角色划分

系统由多个协作 Agent 组成：

#### 3.1.1 任务规划 Agent（Task Planner Agent）
- 解析用户输入的整体需求
- 拆解任务流程
- 控制各子 Agent 的执行顺序

---

#### 3.1.2 大纲生成 Agent（Outline Agent）
- 根据主题和格式要求生成报告大纲
- 明确章节层级及每一章的内容范围
- 输出内容不直接生成完整正文

---

#### 3.1.3 内容写作 Agent（Writing Agent）
- 基于已确认的大纲生成正文内容
- 保证段落之间逻辑衔接自然
- 避免生成无法验证的事实性内容

---

#### 3.1.4 引用检索 Agent（Citation / RAG Agent）
- 检索并筛选相关参考资料
- 生成规范的引用信息
- 建立正文内容与引用来源的映射关系

---

#### 3.1.5 图片与图表 Agent（可选）
- 根据内容需要生成或推荐图表
- 为图片生成说明文字和编号

---

## 4. 文档生成与组装模块

### 4.1 文档构建模块（Document Builder）

负责将 Agent 生成的内容转换为结构化文档，包括：
- 标题层级
- 段落格式
- 图片与图表嵌入
- 参考文献列表自动生成

---

### 4.2 支持的输出格式

- 主要格式：`.docx`
- 可选格式：`.pdf`

---

## 5. 用户交互流程

1. 用户输入主题与格式要求  
2. 系统生成报告大纲供用户确认  
3. 用户确认后生成完整初稿  
4. 用户在文档中自由编辑内容  
5. 用户可：
   - 查看引用来源
   - 对指定章节重新生成
   - 下载最终文档

---

## 6. 非功能性要求

- 系统应通过浏览器访问
- 用户无需配置本地开发环境
- 系统应优先保证可解释性与可控性
- 出现异常或信息不足时应明确提示用户

---

## 7. 设计原则

- 用户对最终内容拥有完全控制权
- 引用来源透明、可验证
- 写作逻辑与文档排版解耦
- Agent 输出为辅助建议，而非最终结论

---

## 8. 使用范围说明

本系统定位为**课程报告 / 论文写作辅助工具**，  
不作为全自动提交工具使用，所有生成内容需用户审核后使用。